input {
        kafka {
                bootstrap_servers => '10.0.0.8:19091'
                topics => ['logs']
                codec => json
                tags => "kafka"
        }
        tcp {
                port => 5000
                tags => "tcp"
        }
}


    
filter {
        if "kafka" in [tags] {
                mutate {
                        lowercase => [ "service" , "level" ]
                }
        }

}


output {
        if "kafka" in [tags] {
                elasticsearch {
                        hosts => ['elasticsearch:9200']
                        index => 'logs-%{service}-%{level}-%{+YYYY.MM.dd}'
                        workers => 1
                }
        }
        if "tcp" in [tags] {
                elasticsearch {
                        hosts => "elasticsearch:9200"
                }
        }

}